<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open CASCADE Technology: Automated Testing System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="occ_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open CASCADE Technology
   &#160;<span id="projectnumber">7.6.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('occt_contribution__tests.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Automated Testing System </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#testmanual_intro">Introduction</a><ul><li class="level2"><a href="#testmanual_intro_basic">Basic Information</a></li>
<li class="level2"><a href="#testmanual_1_2">Intended Use of Automatic Tests</a></li>
<li class="level2"><a href="#testmanual_1_3">Quick Start</a><ul><li class="level3"><a href="#testmanual_1_3_1">Setup</a></li>
<li class="level3"><a href="#testmanual_1_3_2">Running Tests</a></li>
<li class="level3"><a href="#testmanual_1_3_3">Running a Single Test</a></li>
<li class="level3"><a href="#testmanual_intro_quick_create">Creating a New Test</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#testmanual_2">Organization of Test Scripts</a><ul><li class="level2"><a href="#testmanual_2_1">General Layout</a></li>
<li class="level2"><a href="#testmanual_2_2">Test Groups</a><ul><li class="level3"><a href="#testmanual_2_2_1">Group Names</a></li>
<li class="level3"><a href="#testmanual_2_2_2">File &quot;grids.list&quot;</a></li>
<li class="level3"><a href="#testmanual_2_2_3">File &quot;begin&quot;</a></li>
<li class="level3"><a href="#testmanual_2_2_4">File &quot;end&quot;</a></li>
<li class="level3"><a href="#testmanual_2_2_5">File &quot;parse.rules&quot;</a></li>
<li class="level3"><a href="#testmanual_2_2_6">Directory &quot;data&quot;</a></li>
</ul>
</li>
<li class="level2"><a href="#testmanual_2_3">Test Grids</a><ul><li class="level3"><a href="#testmanual_2_3_1">Grid Names</a></li>
<li class="level3"><a href="#testmanual_2_3_2">File &quot;begin&quot;</a></li>
<li class="level3"><a href="#testmanual_2_3_3">File &quot;end&quot;</a></li>
<li class="level3"><a href="#testmanual_2_3_4">File &quot;cases.list&quot;</a></li>
<li class="level3"><a href="#testmanual_2_3_5">Directory &quot;data&quot;</a></li>
</ul>
</li>
<li class="level2"><a href="#testmanual_2_4">Test Cases</a></li>
</ul>
</li>
<li class="level1"><a href="#testmanual_3">Creation And Modification Of Tests</a><ul><li class="level2"><a href="#testmanual_3_1">Choosing Group, Grid, and Test Case Name</a></li>
<li class="level2"><a href="#testmanual_3_2">Adding Data Files Required for a Test</a></li>
<li class="level2"><a href="#testmanual_3_3">Adding new DRAW commands</a></li>
<li class="level2"><a href="#testmanual_3_4">Script Implementation</a></li>
<li class="level2"><a href="#testmanual_details_results">Interpretation of test results</a></li>
<li class="level2"><a href="#testmanual_3_6">Marking BAD cases</a></li>
<li class="level2"><a href="#testmanual_3_7">Marking required output</a></li>
</ul>
</li>
<li class="level1"><a href="#testmanual_4">Advanced Use</a><ul><li class="level2"><a href="#testmanual_4_1">Running Tests on Older Versions of OCCT</a></li>
<li class="level2"><a href="#testmanual_4_2">Adding custom tests</a></li>
<li class="level2"><a href="#testmanual_4_3">Parallel execution of tests</a></li>
<li class="level2"><a href="#testmanual_4_4">Checking non-regression of performance, memory, and visualization</a></li>
</ul>
</li>
<li class="level1"><a href="#testmanual_5">APPENDIX</a><ul><li class="level2"><a href="#testmanual_5_1">Test groups</a><ul><li class="level3"><a href="#testmanual_5_1_1">3rdparty</a></li>
<li class="level3"><a href="#testmanual_5_1_2">blend</a></li>
<li class="level3"><a href="#testmanual_5_1_3">boolean</a></li>
<li class="level3"><a href="#testmanual_5_1_4">bugs</a></li>
<li class="level3"><a href="#testmanual_5_1_5">caf</a></li>
<li class="level3"><a href="#testmanual_5_1_6">chamfer</a></li>
<li class="level3"><a href="#testmanual_5_1_7">de</a></li>
<li class="level3"><a href="#testmanual_5_1_8">demo</a></li>
<li class="level3"><a href="#testmanual_5_1_9">draft</a></li>
<li class="level3"><a href="#testmanual_5_1_10">feat</a></li>
<li class="level3"><a href="#testmanual_5_1_11">heal</a></li>
<li class="level3"><a href="#testmanual_5_1_12">mesh</a></li>
<li class="level3"><a href="#testmanual_5_1_13">mkface</a></li>
<li class="level3"><a href="#testmanual_5_1_14">nproject</a></li>
<li class="level3"><a href="#testmanual_5_1_15">offset</a></li>
<li class="level3"><a href="#testmanual_5_1_16">pipe</a></li>
<li class="level3"><a href="#testmanual_5_1_17">prism</a></li>
<li class="level3"><a href="#testmanual_5_1_18">sewing</a></li>
<li class="level3"><a href="#testmanual_5_1_19">thrusection</a></li>
<li class="level3"><a href="#testmanual_5_1_20">xcaf</a></li>
</ul>
</li>
<li class="level2"><a href="#testmanual_5_2">Mapping of OCCT functionality to grid names in group &lt;em&gt;bugs&lt;/em&gt;</a></li>
<li class="level2"><a href="#testmanual_5_3">Recommended approaches to checking test results</a><ul><li class="level3"><a href="#testmanual_5_3_1">Shape validity</a></li>
<li class="level3"><a href="#testmanual_5_3_2">Shape tolerance</a></li>
<li class="level3"><a href="#testmanual_5_3_3">Shape volume, area, or length</a></li>
<li class="level3"><a href="#testmanual_5_3_4">Memory leaks</a></li>
<li class="level3"><a href="#testmanual_5_3_5">Visualization</a></li>
<li class="level3"><a href="#testmanual_5_3_6">Number of free edges</a></li>
<li class="level3"><a href="#testmanual_5_3_7">Compare numbers</a></li>
<li class="level3"><a href="#testmanual_5_3_8">Check number of sub-shapes</a></li>
<li class="level3"><a href="#testmanual_5_3_9">Check pixel color</a></li>
<li class="level3"><a href="#testmanual_5_3_10">Compute length, area and volume of input shape</a></li>
<li class="level3"><a href="#testmanual_5_3_11">Parse output dump and compare it with reference values</a></li>
<li class="level3"><a href="#testmanual_5_3_12">Compute length of input curve</a></li>
<li class="level3"><a href="#testmanual_5_3_13">Check maximum deflection, number of triangles and nodes in mesh</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_dox_contribution_tests_tests"></a></p>
<h1><a class="anchor" id="testmanual_intro"></a>
Introduction</h1>
<p>This document provides OCCT developers and contributors with an overview and practical guidelines for work with OCCT automatic testing system.</p>
<p>Reading the Introduction should be sufficient for developers to use the test system to control non-regression of the modifications they implement in OCCT. Other sections provide a more in-depth description of the test system, required for modifying the tests and adding new test cases.</p>
<h2><a class="anchor" id="testmanual_intro_basic"></a>
Basic Information</h2>
<p>OCCT automatic testing system is organized around <a class="el" href="occt_user_guides__test_harness.html">DRAW Test Harness</a>, a console application based on Tcl (a scripting language) interpreter extended by OCCT-related commands.</p>
<p><a class="elRef" href="../../refman/html/class_standard.html">Standard</a> OCCT tests are included with OCCT sources and are located in subdirectory <em>tests</em> of the OCCT root folder. Other test folders can be included in the test system, e.g. for testing applications based on OCCT.</p>
<p>The tests are organized in three levels:</p>
<ul>
<li>Group: a group of related test grids, usually testing a particular OCCT functionality (e.g. blend);</li>
<li>Grid: a set of test cases within a group, usually aimed at testing some particular aspect or mode of execution of the relevant functionality (e.g. buildevol);</li>
<li>Test case: a script implementing an individual test (e.g. K4).</li>
</ul>
<p>See <a class="el" href="occt_contribution__tests.html#testmanual_5_1">Test Groups</a> chapter for the current list of available test groups and grids.</p>
<dl class="section note"><dt>Note</dt><dd>Many tests involve data files (typically CAD models) which are located separately and (except a few) are not included with OCCT code. These tests will be skipped if data files are not available.</dd></dl>
<h2><a class="anchor" id="testmanual_1_2"></a>
Intended Use of Automatic Tests</h2>
<p>Each modification made in OCCT code must be checked for non-regression by running the whole set of tests. The developer who makes the modification is responsible for running and ensuring non-regression for the tests available to him.</p>
<p>Note that many tests are based on data files that are confidential and thus available only at OPEN CASCADE. The official certification testing of each change before its integration to master branch of official OCCT Git repository (and finally to the official release) is performed by OPEN CASCADE to ensure non-regression on all existing test cases and supported platforms.</p>
<p>Each new non-trivial modification (improvement, bug fix, new feature) in OCCT should be accompanied by a relevant test case suitable for verifying that modification. This test case is to be added by the developer who provides the modification.</p>
<p>If a modification affects the result of an existing test case, either the modification should be corrected (if it causes regression) or the affected test cases should be updated to account for the modification.</p>
<p>The modifications made in the OCCT code and related test scripts should be included in the same integration to the master branch.</p>
<h2><a class="anchor" id="testmanual_1_3"></a>
Quick Start</h2>
<h3><a class="anchor" id="testmanual_1_3_1"></a>
Setup</h3>
<p>Before running tests, make sure to define environment variable <em>CSF_TestDataPath</em> pointing to the directory containing test data files.</p>
<p>For this it is recommended to add a file <em>DrawAppliInit</em> in the directory which is current at the moment of starting DRAWEXE (normally it is OCCT root directory, <em>$CASROOT </em>). This file is evaluated automatically at the DRAW start.</p>
<p>Example (Windows)</p>
<div class="fragment"><div class="line"><span class="keyword">set</span> env(CSF_TestDataPath) $env(CSF_TestDataPath)\;d:/occt/test-<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a></div>
<div class="ttc" id="anamespaceopencascade_html_a6d2ac61093c47ffeaf4a21cac0c0f9b0"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a></div><div class="ttdeci">GLint GLenum GLsizei GLsizei GLsizei GLint GLsizei const void * data</div></div>
</div><!-- fragment --><p>Note that variable <em>CSF_TestDataPath</em> is set to default value at DRAW start, pointing at the folder <em>$CASROOT/data</em>. In this example, subdirectory <em>d:/occt/test-data</em> is added to this path. Similar code could be used on Linux and Mac OS X except that on non-Windows platforms colon ":" should be used as path separator instead of semicolon ";".</p>
<p>All tests are run from DRAW command prompt (run <em>draw.bat</em> or <em>draw.sh</em> to start it).</p>
<h3><a class="anchor" id="testmanual_1_3_2"></a>
Running Tests</h3>
<p>To run all tests, type command <em>testgrid</em></p>
<p>Example:</p>
<div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[]&gt; testgrid</div>
<div class="ttc" id="aclass_draw_html"><div class="ttname"><a href="../../refman/html/class_draw.html">Draw</a></div></div>
</div><!-- fragment --><p>To run only a subset of test cases, give masks for group, grid, and test case names to be executed. Each argument is a list of file masks separated with commas or spaces; by default "*" is assumed.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[]&gt; testgrid bugs caf,moddata*,xde</div>
</div><!-- fragment --><p>As the tests progress, the result of each test case is reported. At the end of the log a summary of test cases is output, including the list of detected regressions and improvements, if any.</p>
<p>Example:</p>
<div class="fragment"><div class="line">Tests summary</div>
<div class="line"> </div>
<div class="line">CASE 3rdparty export A1: OK </div>
<div class="line">...</div>
<div class="line">CASE pipe standard B1: BAD (known problem)</div>
<div class="line">CASE pipe standard C1: OK</div>
<div class="line">No regressions </div>
<div class="line">Total cases: 208 BAD, 31 SKIPPED, 3 IMPROVEMENT, 1791 OK</div>
<div class="line">Elapsed time: 1 Hours 14 Minutes 33.7384512019 Seconds</div>
<div class="line">Detailed logs are saved in D:/occt/results_2012-06-04T0919</div>
</div><!-- fragment --><p>The tests are considered as non-regressive if only OK, BAD (i.e. known problem), and SKIPPED (i.e. not executed, typically because of lack of a data file) statuses are reported. See <a class="el" href="occt_contribution__tests.html#testmanual_details_results">Interpretation of test results</a> for details.</p>
<p>The results and detailed logs of the tests are saved by default to a new subdirectory of the subdirectory <em>results</em> in the current folder, whose name is generated automatically using the current date and time, prefixed by Git branch name (if Git is available and current sources are managed by Git). If necessary, a non-default output directory can be specified using option <em> -outdir</em> followed by a path to the directory. This directory should be new or empty; use option <em>-overwrite</em> to allow writing results in the existing non-empty directory.</p>
<p>Example: </p><div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[]&gt; testgrid -outdir d:/occt/last_results -overwrite</div>
</div><!-- fragment --><p> In the output directory, a cumulative HTML report <em>summary.html</em> provides links to reports on each test case. An additional report in JUnit-style XML format can be output for use in Jenkins or other continuous integration system.</p>
<p>To re-run the test cases, which were detected as regressions on the previous run, option <em>-regress dirname</em> should be used. <em>dirname</em> is a path to the directory containing the results of the previous run. Only the test cases with <em>FAILED</em> and <em>IMPROVEMENT</em> statuses will be tested.</p>
<p>Example: </p><div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[]&gt; testgrid -regress d:/occt/last_results</div>
</div><!-- fragment --><p>Type <em>help testgrid</em> in DRAW prompt to get help on options supported by <em>testgrid</em> command:</p>
<div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[3]&gt; help testgrid</div>
<div class="line">testgrid: Run all tests, or specified group, or one grid</div>
<div class="line">    Use: testgrid [groupmask [gridmask [casemask]]] [options...]</div>
<div class="line">    Allowed options are:</div>
<div class="line">    -parallel N: run N parallel processes (<span class="keywordflow">default</span> is number of CPUs, 0 to disable)</div>
<div class="line">    -refresh N: save summary logs every N seconds (<span class="keywordflow">default</span> 60, minimal 1, 0 to disable)</div>
<div class="line">    -outdir dirname: <span class="keyword">set</span> log directory (should be empty or non-existing)</div>
<div class="line">    -overwrite: force writing logs in existing non-empty directory</div>
<div class="line">    -xml filename: <a class="codeRef" href="../../refman/html/_std_object__gp___axes_8hxx.html#af18fe2ad7a5e24f5c4e06414d1815e21">write</a> XML report <span class="keywordflow">for</span> Jenkins (in JUnit-like <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a25ecf049b4bb6a81986e7eb0ddcf081d">format</a>)</div>
<div class="line">    -beep: play sound signal at the <a class="codeRef" href="../../refman/html/namespaceopencascade.html#ac9b2829789c77dd61258795f73d3b383">end</a> of the tests</div>
<div class="line">    -regress dirname: re-run only <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> <span class="keyword">set</span> of tests that have been detected as regressions on the previous run.</div>
<div class="line">                      Here <span class="stringliteral">&quot;dirname&quot;</span> is <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> path to the directory containing the results of the previous run.</div>
<div class="line">    Groups, grids, and test cases to be executed can be specified by the list of file </div>
<div class="line">    masks separated by spaces or commas; <span class="keywordflow">default</span> is all (*).</div>
<div class="ttc" id="a_std_object__gp___axes_8hxx_html_af18fe2ad7a5e24f5c4e06414d1815e21"><div class="ttname"><a href="../../refman/html/_std_object__gp___axes_8hxx.html#af18fe2ad7a5e24f5c4e06414d1815e21">write</a></div><div class="ttdeci">StdObjMgt_WriteData &amp; write(StdObjMgt_WriteData &amp;theWriteData, const gp_Ax2d &amp;theAx)</div></div>
<div class="ttc" id="anamespaceopencascade_html_a25ecf049b4bb6a81986e7eb0ddcf081d"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a25ecf049b4bb6a81986e7eb0ddcf081d">format</a></div><div class="ttdeci">GLint GLint GLsizei GLsizei GLsizei GLint GLenum format</div></div>
<div class="ttc" id="anamespaceopencascade_html_a8bfaa44f937da5cb5aea81e82f918d0a"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a></div><div class="ttdeci">GLboolean GLboolean GLboolean GLboolean a</div></div>
<div class="ttc" id="anamespaceopencascade_html_ac9b2829789c77dd61258795f73d3b383"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#ac9b2829789c77dd61258795f73d3b383">end</a></div><div class="ttdeci">GLuint GLuint end</div></div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_1_3_3"></a>
Running a Single Test</h3>
<p>To run a single test, type command <em>test</em> followed by names of group, grid, and test case.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[1]&gt; test blend simple A1</div>
<div class="line">CASE blend simple A1: OK</div>
<div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[2]&gt;</div>
</div><!-- fragment --><p>Note that normally an intermediate output of the script is not shown. The detailed log of the test can be obtained after the test execution by running command <em>"dlog get"</em>.</p>
<p>To see intermediate commands and their output during the test execution, add one more argument <em>"echo"</em> at the end of the command line. Note that with this option the log is not collected and summary is not produced.</p>
<p>Type <em>help test</em> in DRAW prompt to get help on options supported by <em>test</em> command:</p>
<div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[3]&gt; help test</div>
<div class="line">test: Run specified test <span class="keywordflow">case</span></div>
<div class="line"> Use: test group grid casename [options...]</div>
<div class="line"> Allowed options are:</div>
<div class="line"> -echo: all commands and results are echoed immediately,</div>
<div class="line">        but log is not saved and summary is not produced</div>
<div class="line">        It is also possible to use <span class="stringliteral">&quot;1&quot;</span> instead of <span class="stringliteral">&quot;-echo&quot;</span></div>
<div class="line">        If echo is OFF, log is stored in memory and only summary</div>
<div class="line">        is output (the log can be obtained with command <span class="stringliteral">&quot;dlog get&quot;</span>)</div>
<div class="line"> -outfile filename: <span class="keyword">set</span> log file (should be non-existing),</div>
<div class="line">        it is possible to save log file in text file or</div>
<div class="line">        in html file(with snapshot), <span class="keywordflow">for</span> that <span class="stringliteral">&quot;filename&quot;</span></div>
<div class="line">        should have <span class="stringliteral">&quot;.html&quot;</span> extension</div>
<div class="line"> -overwrite: force writing log in existing file</div>
<div class="line"> -beep: play sound signal at the <a class="codeRef" href="../../refman/html/namespaceopencascade.html#ac9b2829789c77dd61258795f73d3b383">end</a> of the test</div>
<div class="line"> -errors: show all lines from the log report that are recognized as errors</div>
<div class="line">        This key will be ignored <span class="keywordflow">if</span> the <span class="stringliteral">&quot;-echo&quot;</span> key is already <span class="keyword">set</span>.</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_intro_quick_create"></a>
Creating a New Test</h3>
<p>The detailed rules of creation of new tests are given in <a class="el" href="occt_contribution__tests.html#testmanual_3">Creation and modification of tests</a> chapter. The following short description covers the most typical situations:</p>
<p>Use prefix <em>bug</em> followed by Mantis issue ID and, if necessary, additional suffixes, for naming the test script, data files, and DRAW commands specific for this test case.</p>
<ol type="1">
<li>If the test requires C++ code, add it as new DRAW command(s) in one of files in <em><a class="elRef" href="../../refman/html/class_q_a_bugs.html">QABugs</a></em> package.</li>
<li>Add script(s) for the test case in the subfolder corresponding to the relevant OCCT module of the group <em>bugs</em> <em>($CASROOT/tests/bugs)</em>. See <a class="el" href="occt_contribution__tests.html#testmanual_5_2">the correspondence map</a>.</li>
<li>In the test script:<ul>
<li>Load all necessary DRAW modules by command <em>pload</em>.</li>
<li>Use command <em>locate_data_file</em> to get a path to data files used by test script. (Make sure to have this command not inside catch statement if it is used.)</li>
<li>Use DRAW commands to reproduce the tested situation.</li>
<li>Make sure that in case of failure the test produces a message containing word "Error" or other recognized by the test system as error (add new error patterns in file parse.rules if necessary).</li>
<li>If the test case reports error due to an existing problem and the fix is not available, add <a class="el" href="occt_contribution__tests.html#testmanual_3_6">TODO</a> statement for each error to mark it as a known problem. The TODO statements must be specific so as to match the actually generated messages but not all similar errors.</li>
<li>To check expected output which should be obtained as the test result, add <a class="el" href="occt_contribution__tests.html#testmanual_3_7">REQUIRED</a> statement for each line of output to mark it as required.</li>
<li>If the test case produces error messages (contained in parse.rules), which are expected in that test and should not be considered as its failure (e.g. test for <em>checkshape</em> command), add REQUIRED statement for each error to mark it as required output.</li>
</ul>
</li>
<li>To check whether the data files needed for the test are already present in the database, use DRAW command <em>testfile</em> (see below). If the data file is already present, use it for a new test instead of adding a duplicate. If the data file(s) are not yet present in the test database, put them to a folder and add it to the environment variable <em>CSF_TestDataPath</em> to be found by the test system. The location of the data files, which need to be accessed by OCC team and put to the official database, should be provided in the comment to Mantis issue, clearly indicating how the names of the files used by the test script match the actual names of the files. The simplest way is to attach the data files to the Mantis issue, with the same names as used by the test script.</li>
<li>Check that the test case runs as expected (test for fix: OK with the fix, FAILED without the fix; test for existing problem: BAD), and integrate it to the Git branch created for the issue.</li>
</ol>
<p>Example:</p>
<ul>
<li>Added files:</li>
</ul>
<div class="fragment"><div class="line">git status -<span class="keywordtype">short</span></div>
<div class="line">A tests/bugs/heal/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>/bug210_a.brep</div>
<div class="line">A tests/bugs/heal/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>/bug210_b.brep</div>
<div class="line">A tests/bugs/heal/bug210_1</div>
<div class="line">A tests/bugs/heal/bug210_2</div>
</div><!-- fragment --><ul>
<li>Test script</li>
</ul>
<div class="fragment"><div class="line">puts <span class="stringliteral">&quot;OCC210 (case 1): Improve FixShape for touching wires&quot;</span></div>
<div class="line"> </div>
<div class="line">restore [locate_data_file bug210_a.brep] <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> </div>
<div class="line"> </div>
<div class="line">fixshape result <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> 0.01 0.01</div>
<div class="line">checkshape result</div>
</div><!-- fragment --><p>DRAW command <em>testfile</em> should be used to check the data files used by the test for possible duplication of content or names. The command accepts the list of paths to files to be checked (as a single argument) and gives a conclusion on each of the files, for instance:</p>
<div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[1]&gt; testfile [glob /my/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>/path/bug12345*]</div>
<div class="line">Collecting info on test <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a> files repository...</div>
<div class="line">Checking <span class="keyword">new</span> file(s)...</div>
<div class="line"> </div>
<div class="line">* /my/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>/path/bug12345.brep: duplicate</div>
<div class="line">  already present under <a class="codeRef" href="../../refman/html/namespaceopencascade.html#ac01e57e97093653a0184fe1116009e15">name</a> bug28773_1.brep</div>
<div class="line">  --&gt; <span class="comment">//server/occt_tests_data/public/brep/bug28773_1.brep</span></div>
<div class="line"> </div>
<div class="line">* /my/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>/path/cadso.brep: <span class="keyword">new</span> file</div>
<div class="line">  Warning: DOS encoding detected, consider converting to</div>
<div class="line">           UNIX unless DOS line ends are needed <span class="keywordflow">for</span> the test</div>
<div class="line">  Warning: shape contains triangulation (946 triangles),</div>
<div class="line">           consider removing them unless they are needed <span class="keywordflow">for</span> the test!</div>
<div class="line">  BREP <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a7333b82c44b6c5e861718e6d4897a7e2">size</a>=201 KiB, nbfaces=33, nbedges=94 -&gt; <span class="keyword">private</span></div>
<div class="line"> </div>
<div class="line">* /my/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>/path/case_8_wire3.brep: already present</div>
<div class="line">  --&gt; <span class="comment">//server/occt_tests_data/public/brep/case_8_wire3.brep</span></div>
<div class="line"> </div>
<div class="line">* /my/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>/path/case_8_wire4.brep: error</div>
<div class="line">  <a class="codeRef" href="../../refman/html/namespaceopencascade.html#ac01e57e97093653a0184fe1116009e15">name</a> is already used by existing file</div>
<div class="line">  --&gt; <span class="comment">//server/occt_tests_data/public/brep/case_8_wire4.brep</span></div>
<div class="ttc" id="anamespaceopencascade_html_a7333b82c44b6c5e861718e6d4897a7e2"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a7333b82c44b6c5e861718e6d4897a7e2">size</a></div><div class="ttdeci">GLuint GLuint GLintptr GLsizeiptr size</div></div>
<div class="ttc" id="anamespaceopencascade_html_ac01e57e97093653a0184fe1116009e15"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#ac01e57e97093653a0184fe1116009e15">name</a></div><div class="ttdeci">GLuint GLsizei GLsizei GLsizei GLenum GLchar * name</div></div>
</div><!-- fragment --><h1><a class="anchor" id="testmanual_2"></a>
Organization of Test Scripts</h1>
<h2><a class="anchor" id="testmanual_2_1"></a>
General Layout</h2>
<p><a class="elRef" href="../../refman/html/class_standard.html">Standard</a> OCCT tests are located in subdirectory tests of the OCCT root folder ($CASROOT).</p>
<p>Additional test folders can be added to the test system by defining environment variable <em>CSF_TestScriptsPath</em>. This should be list of paths separated by semicolons (*;*) on Windows or colons (*:*) on Linux or Mac. Upon DRAW launch, path to <em>tests</em> subfolder of OCCT is added at the end of this variable automatically.</p>
<p>Each test folder is expected to contain:</p><ul>
<li>Optional file <em>parse.rules</em> defining patterns for interpretation of test results, common for all groups in this folder</li>
<li>One or several test group directories.</li>
</ul>
<p>Each group directory contains:</p>
<ul>
<li>File <em>grids.list</em> that identifies this test group and defines list of test grids in it.</li>
<li>Test grids (sub-directories), each containing set of scripts for test cases, and optional files <em>cases.list</em>, <em>parse.rules</em>, <em>begin</em> and <em>end</em>.</li>
<li>Optional sub-directory data</li>
</ul>
<p>By convention, names of test groups, grids, and cases should contain no spaces and be lower-case. The names <em>begin, end, data, parse.rules, grids.list</em> and <em>cases.list</em> are reserved.</p>
<p>General layout of test scripts is shown in Figure 1.</p>
<div class="image">
<img src="tests_image001.png" alt=""/>
<div class="caption">
Layout of tests folder</div></div>
<h2><a class="anchor" id="testmanual_2_2"></a>
Test Groups</h2>
<h3><a class="anchor" id="testmanual_2_2_1"></a>
Group Names</h3>
<p>The names of directories of test groups containing systematic test grids correspond to the functionality tested by each group.</p>
<p>Example:</p>
<div class="fragment"><div class="line">caf</div>
<div class="line">mesh</div>
<div class="line">offset</div>
</div><!-- fragment --><p>Test group <em>bugs</em> is used to collect the tests coming from bug reports. Group <em>demo</em> collects tests of the test system, DRAW, samples, etc.</p>
<h3><a class="anchor" id="testmanual_2_2_2"></a>
File "grids.list"</h3>
<p>This test group contains file <em>grids.list</em>, which defines an ordered list of grids in this group in the following format:</p>
<div class="fragment"><div class="line">001 gridname1</div>
<div class="line">002 gridname2</div>
<div class="line">...</div>
<div class="line">NNN gridnameN</div>
</div><!-- fragment --><p>Example:</p>
<div class="fragment"><div class="line">001 basic</div>
<div class="line">002 advanced</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_2_2_3"></a>
File "begin"</h3>
<p>This file is a Tcl script. It is executed before every test in the current group. Usually it loads necessary <a class="elRef" href="../../refman/html/class_draw.html">Draw</a> commands, sets common parameters and defines additional Tcl functions used in test scripts.</p>
<p>Example:</p>
<div class="fragment"><div class="line">pload TOPTEST ;# load topological command</div>
<div class="line"><span class="keyword">set</span> cpulimit 300 ;# <span class="keyword">set</span> maximum time allowed <span class="keywordflow">for</span> script execution</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_2_2_4"></a>
File "end"</h3>
<p>This file is a TCL script. It is executed after every test in the current group. Usually it checks the results of script work, makes a snap-shot of the viewer and writes <em>TEST COMPLETED</em> to the output.</p>
<p>Note: <em>TEST COMPLETED</em> string should be present in the output to indicate that the test is finished without crash.</p>
<p>See <a class="el" href="occt_contribution__tests.html#testmanual_3">Creation and modification of tests</a> chapter for more information.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> { [isdraw result] } {</div>
<div class="line">    checkshape result</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    puts <span class="stringliteral">&quot;Error: The result shape can not be built&quot;</span></div>
<div class="line">}</div>
<div class="line">puts <span class="stringliteral">&quot;TEST COMPLETED&quot;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_2_2_5"></a>
File "parse.rules"</h3>
<p>The test group may contain <em>parse.rules</em> file. This file defines patterns used for analysis of the test execution log and deciding the status of the test run.</p>
<p>Each line in the file should specify a status (single word), followed by a regular expression delimited by slashes (*/*) that will be matched against lines in the test output log to check if it corresponds to this status.</p>
<p>The regular expressions should follow <a href="https://www.tcl.tk/man/tcl/TclCmd/re_syntax.htm">Tcl syntax</a>, with a special exception that "\b" is considered as word limit (Perl-style), in addition to "\y" used in Tcl.</p>
<p>The rest of the line can contain a comment message, which will be added to the test report when this status is detected.</p>
<p>Example:</p>
<div class="fragment"><div class="line">FAILED /\b[Ee]xception\b/ exception</div>
<div class="line">FAILED /\bError\b/ error</div>
<div class="line">SKIPPED /Cannot open file for reading/ data file is missing</div>
<div class="line">SKIPPED /Could not read file .*, abandon/ data file is missing</div>
</div><!-- fragment --><p>Lines starting with a *#* character and blank lines are ignored to allow comments and spacing.</p>
<p>See <a class="el" href="occt_contribution__tests.html#testmanual_details_results">Interpretation of test results</a> chapter for details.</p>
<p>If a line matches several rules, the first one applies. Rules defined in the grid are checked first, then rules in the group, then rules in the test root directory. This allows defining some rules on the grid level with status <em>IGNORE</em> to ignore messages that would otherwise be treated as errors due to the group level rules.</p>
<p>Example:</p>
<div class="fragment"><div class="line">FAILED /\\bFaulty\\b/ bad shape</div>
<div class="line">IGNORE /^Error [23]d = [\d.-]+/ debug output of blend command</div>
<div class="line">IGNORE /^Tcl Exception: tolerance ang : [\d.-]+/ blend failure</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_2_2_6"></a>
Directory "data"</h3>
<p>The test group may contain subdirectory <em>data</em>, where test scripts shared by different test grids can be put. See also <a class="el" href="occt_contribution__tests.html#testmanual_2_3_5">Directory data</a>.</p>
<h2><a class="anchor" id="testmanual_2_3"></a>
Test Grids</h2>
<h3><a class="anchor" id="testmanual_2_3_1"></a>
Grid Names</h3>
<p>The folder of a test group can have several sub-directories (Grid 1… Grid N) defining test grids. Each directory contains a set of related test cases. The name of a directory should correspond to its contents.</p>
<p>Example:</p>
<div class="fragment"><div class="line">caf</div>
<div class="line">   basic</div>
<div class="line">   bugs</div>
<div class="line">   presentation</div>
</div><!-- fragment --><p>Here <em>caf</em> is the name of the test group and <em>basic</em>, <em>bugs</em>, <em>presentation</em>, etc. are the names of grids.</p>
<h3><a class="anchor" id="testmanual_2_3_2"></a>
File "begin"</h3>
<p>This file is a TCL script executed before every test in the current grid.</p>
<p>Usually it sets variables specific for the current grid.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><span class="keyword">set</span> command bopfuse ;# command tested in <span class="keyword">this</span> grid</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_2_3_3"></a>
File "end"</h3>
<p>This file is a TCL script executed after every test in current grid.</p>
<p>Usually it executes a specific sequence of commands common for all tests in the grid.</p>
<p>Example:</p>
<div class="fragment"><div class="line">vdump $imagedir/${casename}.png ;# makes <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> snap-shot of <a class="codeRef" href="../../refman/html/class_a_i_s.html">AIS</a> viewer</div>
<div class="ttc" id="aclass_a_i_s_html"><div class="ttname"><a href="../../refman/html/class_a_i_s.html">AIS</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_2_3_4"></a>
File "cases.list"</h3>
<p>The grid directory can contain an optional file cases.list defining an alternative location of the test cases. This file should contain a single line defining the relative path to the collection of test cases.</p>
<p>Example:</p>
<div class="fragment"><div class="line">../data/simple</div>
</div><!-- fragment --><p>This option is used for creation of several grids of tests with the same data files and operations but performed with differing parameters. The common scripts are usually located place in the common subdirectory of the test group, <em>data/simple</em> for example.</p>
<p>If file <em>cases.list</em> exists, the grid directory should not contain any test cases. The specific parameters and pre- and post-processing commands for test execution in this grid should be defined in the files <em>begin</em> and <em>end</em>.</p>
<h3><a class="anchor" id="testmanual_2_3_5"></a>
Directory "data"</h3>
<p>The test grid may contain subdirectory <em>data</em>, containing data files used in tests (BREP, IGES, STEP, etc.) of this grid.</p>
<h2><a class="anchor" id="testmanual_2_4"></a>
Test Cases</h2>
<p>The test case is a TCL script, which performs some operations using DRAW commands and produces meaningful messages that can be used to check the validity of the result.</p>
<p>Example:</p>
<div class="fragment"><div class="line">pcylinder c1 10 20 ;# create <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a61a2af742558436661957e7c0f480e80">first</a> cylinder</div>
<div class="line">pcylinder c2 5 20 ;# create second cylinder</div>
<div class="line">ttranslate c2 5 0 10 ;# translate second cylinder to <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5ca01742b10640986e9f619449215b72">x</a>,<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a26a4c5ffb147d5929e52e387b3acf0d0">y</a>,<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5573e59bba6c0c54b0de234893422329">z</a></div>
<div class="line">bsection result c1 c2 ;# create <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> section of two cylinders</div>
<div class="line">checksection result ;# will output error <a class="codeRef" href="../../refman/html/namespaceopencascade.html#abf5abf9ce99566610ad945261de6dfa4">message</a> <span class="keywordflow">if</span> result is bad</div>
<div class="ttc" id="anamespaceopencascade_html_a26a4c5ffb147d5929e52e387b3acf0d0"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a26a4c5ffb147d5929e52e387b3acf0d0">y</a></div><div class="ttdeci">GLint GLint GLint GLint GLint GLint y</div></div>
<div class="ttc" id="anamespaceopencascade_html_a5573e59bba6c0c54b0de234893422329"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a5573e59bba6c0c54b0de234893422329">z</a></div><div class="ttdeci">GLint GLint GLint z</div></div>
<div class="ttc" id="anamespaceopencascade_html_a5ca01742b10640986e9f619449215b72"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a5ca01742b10640986e9f619449215b72">x</a></div><div class="ttdeci">GLint GLint GLint GLint GLint x</div></div>
<div class="ttc" id="anamespaceopencascade_html_a61a2af742558436661957e7c0f480e80"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a61a2af742558436661957e7c0f480e80">first</a></div><div class="ttdeci">GLint first</div></div>
<div class="ttc" id="anamespaceopencascade_html_abf5abf9ce99566610ad945261de6dfa4"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#abf5abf9ce99566610ad945261de6dfa4">message</a></div><div class="ttdeci">GLuint GLsizei const GLchar * message</div></div>
</div><!-- fragment --><p>The test case can have any name (except for the reserved names <em>begin, end, data, cases.list</em> and <em>parse.rules</em>). For systematic grids it is usually a capital English letter followed by a number.</p>
<p>Example:</p>
<div class="fragment"><div class="line">A1</div>
<div class="line">A2</div>
<div class="line">B1</div>
<div class="line">B2</div>
</div><!-- fragment --><p>Such naming facilitates compact representation of tests execution results in tabular format within HTML reports.</p>
<h1><a class="anchor" id="testmanual_3"></a>
Creation And Modification Of Tests</h1>
<p>This section describes how to add new tests and update existing ones.</p>
<h2><a class="anchor" id="testmanual_3_1"></a>
Choosing Group, Grid, and Test Case Name</h2>
<p>The new tests are usually added in the frame of processing issues in OCCT Mantis tracker. Such tests in general should be added to group bugs, in the grid corresponding to the affected OCCT functionality. See <a class="el" href="occt_contribution__tests.html#testmanual_5_2">Mapping of OCCT functionality to grid names in group bugs</a>.</p>
<p>New grids can be added as necessary to contain tests for the functionality not yet covered by existing test grids. The test case name in the bugs group should be prefixed by the ID of the corresponding issue in Mantis (without leading zeroes) with prefix <em>bug</em>. It is recommended to add a suffix providing a hint on the tested situation. If more than one test is added for a bug, they should be distinguished by suffixes; either meaningful or just ordinal numbers.</p>
<p>Example:</p>
<div class="fragment"><div class="line">bug12345_coaxial</div>
<div class="line">bug12345_orthogonal_1</div>
<div class="line">bug12345_orthogonal_2</div>
</div><!-- fragment --><p>If the new test corresponds to a functionality already covered by the existing systematic test grid (e.g. group <em>mesh</em> for <em>BRepMesh</em> issues), this test can be added (or moved later by OCC team) to that grid.</p>
<h2><a class="anchor" id="testmanual_3_2"></a>
Adding Data Files Required for a Test</h2>
<p>It is advisable to make self-contained test scripts whenever possible, so as they could be used in the environments where data files are not available. For that simple geometric objects and shapes can be created using DRAW commands in the test script itself.</p>
<p>If the test requires a data file, it should be put to the directory listed in environment variable <em>CSF_TestDataPath</em>. Alternatively, it can be put to subdirectory <em>data</em> of the test grid. It is recommended to prefix the data file with the corresponding issue id prefixed by <em>bug</em>, e.g. <em>bug12345_face1.brep</em>, to avoid possible conflicts with names of existing data files.</p>
<p>Note that when the test is integrated to the master branch, OCC team will move the data file to the data files repository, to keep OCCT sources repository clean from data files.</p>
<p>When you prepare a test script, try to minimize the size of involved data model. For instance, if the problem detected on a big shape can be reproduced on a single face extracted from that shape, use only that face in the test.</p>
<h2><a class="anchor" id="testmanual_3_3"></a>
Adding new DRAW commands</h2>
<p>If the test cannot be implemented using available DRAW commands, consider the following possibilities:</p><ul>
<li>If the existing DRAW command can be extended to enable possibility required for a test in a natural way (e.g. by adding an option to activate a specific mode of the algorithm), this way is recommended. This change should be appropriately documented in a relevant Mantis issue.</li>
<li>If the new command is needed to access OCCT functionality not exposed to DRAW previously, and this command can be potentially reused (for other tests), it should be added to the package where similar commands are implemented (use <em>getsource</em> DRAW command to get the package name). The name and arguments of the new command should be chosen to keep similarity with the existing commands. This change should be documented in a relevant Mantis issue.</li>
<li>Otherwise the new command implementing the actions needed for this particular test should be added in <em><a class="elRef" href="../../refman/html/class_q_a_bugs.html">QABugs</a></em> package. The command name should be formed by the Mantis issue ID prefixed by <em>bug</em>, e.g. <em>bug12345</em>.</li>
</ul>
<p>Note that a DRAW command is expected to return 0 in case of a normal completion, and 1 (Tcl exception) if it is incorrectly used (e.g. a wrong number of input arguments). Thus if the new command needs to report a test error, this should be done by outputting an appropriate error message rather than by returning a non-zero value. File names must be encoded in the script rather than in the DRAW command and passed to the DRAW command as an argument.</p>
<h2><a class="anchor" id="testmanual_3_4"></a>
Script Implementation</h2>
<p>The test should run commands necessary to perform the tested operations, in general assuming a clean DRAW session. The required DRAW modules should be loaded by <em>pload</em> command, if it is not done by <em>begin</em> script. The messages produced by commands in a standard output should include identifiable messages on the discovered problems if any.</p>
<p>Usually the script represents a set of commands that a person would run interactively to perform the operation and see its results, with additional comments to explain what happens.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="preprocessor"># Simple test of fusing box and sphere</span></div>
<div class="line">box <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a> 10 10 10 </div>
<div class="line">sphere s 5</div>
<div class="line">bfuse result <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a> s</div>
<div class="line">checkshape result</div>
<div class="ttc" id="anamespaceopencascade_html_a5bb39a61f24f11176540a2c890f722bb"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a></div><div class="ttdeci">GLboolean GLboolean GLboolean b</div></div>
</div><!-- fragment --><p>Make sure that file <em>parse.rules</em> in the grid or group directory contains a regular expression to catch possible messages indicating the failure of the test.</p>
<p>For instance, for catching errors reported by <em>checkshape</em> command relevant grids define a rule to recognize its report by the word <em>Faulty</em>:</p>
<div class="fragment"><div class="line">FAILED /\bFaulty\b/ bad shape</div>
</div><!-- fragment --><p>For the messages generated in the script it is recommended to use the word 'Error' in the error message.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><span class="keyword">set</span> expected_length 11</div>
<div class="line"><span class="keywordflow">if</span> { [expr $actual_length - $expected_length] &gt; 0.001 } {</div>
<div class="line">    puts <span class="stringliteral">&quot;Error: The length of the edge should be $expected_length&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>At the end, the test script should output <em>TEST COMPLETED</em> string to mark a successful completion of the script. This is often done by the <em>end</em> script in the grid.</p>
<p>During execution of a test, the following Tcl variables are defined on global level:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Variable   </th><th class="markdownTableHeadNone">Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">dirname   </td><td class="markdownTableBodyNone">Path to the root directory of the current set of test scripts    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">groupname   </td><td class="markdownTableBodyNone">Name of the test group (subfolder of $dirname)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">gridname   </td><td class="markdownTableBodyNone">Name of the test grid (subfolder of $dirname/$gridname)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">casename   </td><td class="markdownTableBodyNone">Name of the test    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">imagedir   </td><td class="markdownTableBodyNone">Path to folder where test log and other artifacts are saved   </td></tr>
</table>
<p>The test script can use some data stored in a separate file (e.g. reference results of the test execution). Such file can be put in subfolder <em>data</em> of the test grid directory. During execution of the test, location of such data file can be constructed using the variables listed above.</p>
<p>Example:</p>
<div class="fragment"><div class="line">checkresult $result $::dirname/$::groupname/$::gridname/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>/${::casename}.txt</div>
</div><!-- fragment --><p>CAD models and other data files which are not going to change over time should be stored separately from the source repository. Use Tcl procedure <em>locate_data_file</em> to get a path to such data files, instead of coding the path explicitly. For the file to be found by that procedure, add directory that contains it into the environment variable <em>CSF_TestDataPath</em> (list of paths separated by semicolons on Windows or colons on other platforms). The search is recursive, thus adding only root folder of a directory containing data files is sufficient. If the file is not found, <em>locate_data_file</em> will raise exception, and the test will be reported as SKIPPED.</p>
<p>Example:</p>
<div class="fragment"><div class="line">stepread [locate_data_file CAROSKI_COUPELLE.step] <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> *</div>
</div><!-- fragment --><p>When the test needs to produce some snapshots or other artefacts, use Tcl variable <em>imagedir</em> as the location where such files should be put.</p><ul>
<li>Command <em>testgrid</em> sets this variable to the subdirectory of the results folder corresponding to the grid.</li>
<li>Command <em>test</em> by default creates a dedicated temporary directory in the system temporary folder (normally the one specified by environment variable <em>TempDir</em>, <em>TEMP</em>, or <em>TMP</em>) for each execution, and sets <em>imagedir</em> to that location.</li>
</ul>
<p>However if variable <em>imagedir</em> is defined on the top level of Tcl interpreter, command <em>test</em> will use it instead of creating a new directory.</p>
<p>Use Tcl variable <em>casename</em> to prefix all files produced by the test. This variable is set to the name of the test case.</p>
<p>The test system can recognize an image file (snapshot) and include it in HTML log and differences if its name starts with the name of the test case (use variable <em>casename</em>), optionally followed by underscore or dash and arbitrary suffix.</p>
<p>The image format (defined by extension) should be <em>png</em>.</p>
<p>Example: </p><div class="fragment"><div class="line">xwd $::imagedir/${::casename}.png</div>
<div class="line">vdisplay result; vfit</div>
<div class="line">vdump $::imagedir/${::casename}-axo.png</div>
<div class="line">vfront; vfit</div>
<div class="line">vdump $::imagedir/${::casename}-front.png</div>
</div><!-- fragment --><p>would produce: </p><div class="fragment"><div class="line">A1.png</div>
<div class="line">A1-axo.png</div>
<div class="line">A1-front.png</div>
</div><!-- fragment --><p>Note that OCCT must be built with FreeImage support to be able to produce usable images.</p>
<p>In order to ensure that the test works as expected in different environments, observe the following additional rules:</p><ul>
<li>Avoid using external commands such as <em>grep, rm,</em> etc., as these commands can be absent on another system (e.g. on Windows); use facilities provided by Tcl instead.</li>
<li>Do not put call to <em>locate_data_file</em> in catch statement &ndash; this can prevent correct interpretation of the missing data file by the test system.</li>
<li>Do not use commands <em>decho</em> and <em>dlog</em> in the test script, to avoid interference with use of these commands by the test system.</li>
</ul>
<h2><a class="anchor" id="testmanual_details_results"></a>
Interpretation of test results</h2>
<p>The result of the test is evaluated by checking its output against patterns defined in the files <em>parse.rules</em> of the grid and group.</p>
<p>The OCCT test system recognizes five statuses of the test execution:</p><ul>
<li>SKIPPED: reported if a line matching SKIPPED pattern is found (prior to any FAILED pattern). This indicates that the test cannot be run in the current environment; the most typical case is the absence of the required data file.</li>
<li>FAILED: reported if a line matching pattern with status FAILED is found (unless it is masked by the preceding IGNORE pattern or a TODO or REQUIRED statement), or if message TEST COMPLETED or at least one of REQUIRED patterns is not found. This indicates that the test has produced a bad or unexpected result, and usually means a regression.</li>
<li>BAD: reported if the test script output contains one or several TODO statements and the corresponding number of matching lines in the log. This indicates a known problem. The lines matching TODO statements are not checked against other patterns and thus will not cause a FAILED status. <br  />
</li>
<li>IMPROVEMENT: reported if the test script output contains a TODO statement for which no corresponding line is found. This is a possible indication of improvement (a known problem has disappeared).</li>
<li>OK: reported if none of the above statuses have been assigned. This means that the test has passed without problems.</li>
</ul>
<p>Other statuses can be specified in <em>parse.rules</em> files, these will be classified as FAILED.</p>
<p>For integration of the change to OCCT repository, all tests should return either OK or BAD status. The new test created for an unsolved problem should return BAD. The new test created for a fixed problem should return FAILED without the fix, and OK with the fix.</p>
<h2><a class="anchor" id="testmanual_3_6"></a>
Marking BAD cases</h2>
<p>If the test produces an invalid result at a certain moment then the corresponding bug should be created in the OCCT issue tracker located at <a href="https://tracker.dev.opencascade.org">https://tracker.dev.opencascade.org</a>, and the problem should be marked as TODO in the test script.</p>
<p>The following statement should be added to such a test script: </p><div class="fragment"><div class="line">puts <span class="stringliteral">&quot;TODO BugNumber ListOfPlatforms: RegularExpression&quot;</span></div>
</div><!-- fragment --><p>Here:</p><ul>
<li><em>BugNumber</em> is the bug ID in the tracker. For example: #12345.</li>
<li><em>ListOfPlatforms</em> is a list of platforms, at which the bug is reproduced (Linux, Windows, MacOS, or All). Note that the platform name is custom for the OCCT test system; Use procedure <em>checkplatform</em> to get the platform name.</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[2]&gt; checkplatform</div>
<div class="line">Windows</div>
</div><!-- fragment --><ul>
<li>RegularExpression is a regular expression, which should be matched against the line indicating the problem in the script output.</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">puts <span class="stringliteral">&quot;TODO #22622 Mandriva2008: Abort .* an exception was raised&quot;</span></div>
</div><!-- fragment --><p>The parser checks the test output and if an output line matches the <em>RegularExpression</em> then it will be assigned a BAD status instead of FAILED.</p>
<p>A separate TODO line must be added for each output line matching an error expression to mark the test as BAD. If not all TODO messages are found in the test log, the test will be considered as possible improvement.</p>
<p>To mark the test as BAD for an incomplete case (when the final <em>TEST COMPLETE</em> message is missing) the expression <em>TEST INCOMPLETE</em> should be used instead of the regular expression.</p>
<p>Example:</p>
<div class="fragment"><div class="line">puts <span class="stringliteral">&quot;TODO OCC22817 All: exception.+There are no suitable edges&quot;</span></div>
<div class="line">puts <span class="stringliteral">&quot;TODO OCC22817 All: \\*\\* Exception \\*\\*&quot;</span></div>
<div class="line">puts <span class="stringliteral">&quot;TODO OCC22817 All: TEST INCOMPLETE&quot;</span></div>
</div><!-- fragment --><h2><a class="anchor" id="testmanual_3_7"></a>
Marking required output</h2>
<p>To check the obtained test output matches the expected results considered correct, add REQUIRED statement for each specific message. For that, the following statement should be added to the corresponding test script:</p>
<div class="fragment"><div class="line">puts <span class="stringliteral">&quot;REQUIRED ListOfPlatforms: RegularExpression&quot;</span></div>
</div><!-- fragment --><p>Here <em>ListOfPlatforms</em> and <em>RegularExpression</em> have the same meaning as in TODO statements described above.</p>
<p>The REQUIRED statement can also be used to mask the message that would normally be interpreted as error (according to the rules defined in <em>parse.rules</em>) but should not be considered as such within the current test.</p>
<p>Example: </p><div class="fragment"><div class="line">puts <span class="stringliteral">&quot;REQUIRED Linux: Faulty shapes in variables faulty_1 to faulty_5&quot;</span></div>
</div><!-- fragment --><p>This statement notifies test system that errors reported by <em>checkshape</em> command are expected in that test case, and test should be considered as OK if this message appears, despite of presence of general rule stating that 'Faulty' signals failure.</p>
<p>If output does not contain required statement, test case will be marked as FAILED.</p>
<h1><a class="anchor" id="testmanual_4"></a>
Advanced Use</h1>
<h2><a class="anchor" id="testmanual_4_1"></a>
Running Tests on Older Versions of OCCT</h2>
<p>Sometimes it might be necessary to run tests on the previous versions of OCCT (&lt;= 6.5.4) that do not include this test system. This can be done by adding DRAW configuration file <em>DrawAppliInit</em> in the directory, which is current by the moment of DRAW start-up, to load test commands and to define the necessary environment.</p>
<p>Note: in OCCT 6.5.3, file <em>DrawAppliInit</em> already exists in <em>$CASROOT/src/DrawResources</em>, new commands should be added to this file instead of a new one in the current directory.</p>
<p>For example, let us assume that <em>d:/occt</em> contains an up-to-date version of OCCT sources with tests, and the test data archive is unpacked to <em>d:/test-data</em>):</p>
<div class="fragment"><div class="line"><span class="keyword">set</span> env(CASROOT) d:/occt</div>
<div class="line"><span class="keyword">set</span> env(CSF_TestScriptsPath) $env(CASROOT)/tests</div>
<div class="line">source $env(CASROOT)/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a866c2b57ba3c02442fa4b2d2045f6b86">src</a>/DrawResources/TestCommands.tcl</div>
<div class="line"><span class="keyword">set</span> env(CSF_TestDataPath) $env(CASROOT)/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>;d:/test-<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a></div>
<div class="line"><span class="keywordflow">return</span></div>
<div class="ttc" id="anamespaceopencascade_html_a866c2b57ba3c02442fa4b2d2045f6b86"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a866c2b57ba3c02442fa4b2d2045f6b86">src</a></div><div class="ttdeci">GLenum src</div></div>
</div><!-- fragment --><p>Note that on older versions of OCCT the tests are run in compatibility mode and thus not all output of the test command can be captured; this can lead to absence of some error messages (can be reported as either a failure or an improvement).</p>
<h2><a class="anchor" id="testmanual_4_2"></a>
Adding custom tests</h2>
<p>You can extend the test system by adding your own tests. For that it is necessary to add paths to the directory where these tests are located, and one or more additional data directories, to the environment variables <em>CSF_TestScriptsPath</em> and <em>CSF_TestDataPath</em>. The recommended way for doing this is using DRAW configuration file <em>DrawAppliInit</em> located in the directory which is current by the moment of DRAW start-up.</p>
<p>Use Tcl command <em>_path_separator</em> to insert a platform-dependent separator to the path list.</p>
<p>For example: </p><div class="fragment"><div class="line"><span class="keyword">set</span> env(CSF_TestScriptsPath) \</div>
<div class="line">  $env(TestScriptsPath)[_path_separator]d:/MyOCCTProject/tests</div>
<div class="line"><span class="keyword">set</span> env(CSF_TestDataPath) \</div>
<div class="line">  d:/occt/test-<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a>[_path_separator]d:/MyOCCTProject/<a class="codeRef" href="../../refman/html/namespaceopencascade.html#a6d2ac61093c47ffeaf4a21cac0c0f9b0">data</a></div>
<div class="line">return ;# <span class="keyword">this</span> is to avoid an echo of the last command above in cout</div>
</div><!-- fragment --><h2><a class="anchor" id="testmanual_4_3"></a>
Parallel execution of tests</h2>
<p>For better efficiency, on computers with multiple CPUs the tests can be run in parallel mode. This is default behavior for command <em>testgrid</em> : the tests are executed in parallel processes (their number is equal to the number of CPUs available on the system). In order to change this behavior, use option parallel followed by the number of processes to be used (1 or 0 to run sequentially).</p>
<p>Note that the parallel execution is only possible if Tcl extension package <em>Thread</em> is installed. If this package is not available, <em>testgrid</em> command will output a warning message.</p>
<h2><a class="anchor" id="testmanual_4_4"></a>
Checking non-regression of performance, memory, and visualization</h2>
<p>Some test results are very dependent on the characteristics of the workstation, where they are performed, and thus cannot be checked by comparison with some predefined values. These results can be checked for non-regression (after a change in OCCT code) by comparing them with the results produced by the version without this change. The most typical case is comparing the result obtained in a branch created for integration of a fix (CR***) with the results obtained on the master branch before that change is made.</p>
<p>OCCT test system provides a dedicated command <em>testdiff</em> for comparing CPU time of execution, memory usage, and images produced by the tests.</p>
<div class="fragment"><div class="line">testdiff dir1 dir2 [groupname [gridname]] [options...]</div>
</div><!-- fragment --><p> Here <em>dir1</em> and <em>dir2</em> are directories containing logs of two test runs.</p>
<p>Possible options are:</p><ul>
<li><em>-save &lt;filename&gt; </em> &ndash; saves the resulting log in a specified file (<em>$dir1/diff-$dir2.log</em> by default). HTML log is saved with the same name and extension .html;</li>
<li><em>-status {same|ok|all}</em> &ndash; allows filtering compared cases by their status:<ul>
<li><em>same</em> &ndash; only cases with same status are compared (default);</li>
<li><em>ok</em> &ndash; only cases with OK status in both logs are compared;</li>
<li><em>all</em> &ndash; results are compared regardless of status;</li>
</ul>
</li>
<li><em>-verbose &lt;level&gt; </em> &ndash; defines the scope of output data:<ul>
<li>1 &ndash; outputs only differences;</li>
<li>2 &ndash; additionally outputs the list of logs and directories present in one of directories only;</li>
<li>3 &ndash; (by default) additionally outputs progress messages;</li>
</ul>
</li>
<li><em>-image [filename]</em> - compare images and save the resulting log in specified file (<em>$dir1/diffimage-$dir2.log</em> by default)</li>
<li><em>-cpu [filename]</em> - compare overall CPU and save the resulting log in specified file (<em>$dir1/diffcpu-$dir2.log</em> by default)</li>
<li><em>-memory [filename]</em> - compare memory delta and save the resulting log in specified file (<em>$dir1/diffmemory-$dir2.log</em> by default)</li>
<li><em>-highlight_percent &lt;value&gt;</em> - highlight considerable (&gt;value in %) deviations of CPU and memory (default value is 5%)</li>
</ul>
<p>Example:</p>
<div class="fragment"><div class="line"><a class="codeRef" href="../../refman/html/class_draw.html">Draw</a>[]&gt; testdiff results/CR12345-2012-10-10T08:00 results/master-2012-10-09T21:20 </div>
</div><!-- fragment --><p>Particular tests can generate additional data that need to be compared by <em>testdiff</em> command. For that, for each parameter to be controlled, the test should produce the line containing keyword "COUNTER* followed by arbitrary name of the parameter, then colon and numeric value of the parameter.</p>
<p>Example of test code:</p>
<div class="fragment"><div class="line">puts <span class="stringliteral">&quot;COUNTER Memory heap usage at step 5: [meminfo h]&quot;</span></div>
</div><!-- fragment --><h1><a class="anchor" id="testmanual_5"></a>
APPENDIX</h1>
<h2><a class="anchor" id="testmanual_5_1"></a>
Test groups</h2>
<h3><a class="anchor" id="testmanual_5_1_1"></a>
3rdparty</h3>
<p>This group allows testing the interaction of OCCT and 3rdparty products.</p>
<p>DRAW module: VISUALIZATION.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">export   </td><td class="markdownTableBodyLeft">vexport   </td><td class="markdownTableBodyLeft">export of images to different formats    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">fonts   </td><td class="markdownTableBodyLeft">vtrihedron, vcolorscale, vdrawtext   </td><td class="markdownTableBodyLeft">display of fonts   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_2"></a>
blend</h3>
<p>This group allows testing blends (fillets) and related operations.</p>
<p>DRAW module: MODELING.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">simple   </td><td class="markdownTableBodyLeft">blend   </td><td class="markdownTableBodyLeft">fillets on simple shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">complex   </td><td class="markdownTableBodyLeft">blend   </td><td class="markdownTableBodyLeft">fillets on complex shapes, non-trivial geometry    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">tolblend_simple   </td><td class="markdownTableBodyLeft">tolblend, blend   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">buildevol   </td><td class="markdownTableBodyLeft">buildevol   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">tolblend_buildvol   </td><td class="markdownTableBodyLeft">tolblend, buildevol   </td><td class="markdownTableBodyLeft">use of additional command tolblend    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bfuseblend   </td><td class="markdownTableBodyLeft">bfuseblend   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">encoderegularity   </td><td class="markdownTableBodyLeft">encoderegularity   </td><td class="markdownTableBodyLeft"></td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_3"></a>
boolean</h3>
<p>This group allows testing Boolean operations.</p>
<p>DRAW module: MODELING (packages <em><a class="elRef" href="../../refman/html/class_b_o_p_test.html">BOPTest</a></em> and <em><a class="elRef" href="../../refman/html/class_b_rep_test.html">BRepTest</a></em>).</p>
<p>Grids names are based on name of the command used, with suffixes:</p><ul>
<li><em>_2d</em> &ndash; for tests operating with 2d objects (wires, wires, 3d objects, etc.);</li>
<li><em>_simple</em> &ndash; for tests operating on simple shapes (boxes, cylinders, toruses, etc.);</li>
<li><em>_complex</em> &ndash; for tests dealing with complex shapes.</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bcommon_2d   </td><td class="markdownTableBodyLeft">bcommon   </td><td class="markdownTableBodyLeft">Common operation (old algorithm), 2d    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bcommon_complex   </td><td class="markdownTableBodyLeft">bcommon   </td><td class="markdownTableBodyLeft">Common operation (old algorithm), complex shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bcommon_simple   </td><td class="markdownTableBodyLeft">bcommon   </td><td class="markdownTableBodyLeft">Common operation (old algorithm), simple shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bcut_2d   </td><td class="markdownTableBodyLeft">bcut   </td><td class="markdownTableBodyLeft">Cut operation (old algorithm), 2d    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bcut_complex   </td><td class="markdownTableBodyLeft">bcut   </td><td class="markdownTableBodyLeft">Cut operation (old algorithm), complex shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bcut_simple   </td><td class="markdownTableBodyLeft">bcut   </td><td class="markdownTableBodyLeft">Cut operation (old algorithm), simple shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bcutblend   </td><td class="markdownTableBodyLeft">bcutblend   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bfuse_2d   </td><td class="markdownTableBodyLeft">bfuse   </td><td class="markdownTableBodyLeft">Fuse operation (old algorithm), 2d    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bfuse_complex   </td><td class="markdownTableBodyLeft">bfuse   </td><td class="markdownTableBodyLeft">Fuse operation (old algorithm), complex shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bfuse_simple   </td><td class="markdownTableBodyLeft">bfuse   </td><td class="markdownTableBodyLeft">Fuse operation (old algorithm), simple shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bopcommon_2d   </td><td class="markdownTableBodyLeft">bopcommon   </td><td class="markdownTableBodyLeft">Common operation, 2d    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bopcommon_complex   </td><td class="markdownTableBodyLeft">bopcommon   </td><td class="markdownTableBodyLeft">Common operation, complex shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bopcommon_simple   </td><td class="markdownTableBodyLeft">bopcommon   </td><td class="markdownTableBodyLeft">Common operation, simple shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bopcut_2d   </td><td class="markdownTableBodyLeft">bopcut   </td><td class="markdownTableBodyLeft">Cut operation, 2d    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bopcut_complex   </td><td class="markdownTableBodyLeft">bopcut   </td><td class="markdownTableBodyLeft">Cut operation, complex shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bopcut_simple   </td><td class="markdownTableBodyLeft">bopcut   </td><td class="markdownTableBodyLeft">Cut operation, simple shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bopfuse_2d   </td><td class="markdownTableBodyLeft">bopfuse   </td><td class="markdownTableBodyLeft">Fuse operation, 2d    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bopfuse_complex   </td><td class="markdownTableBodyLeft">bopfuse   </td><td class="markdownTableBodyLeft">Fuse operation, complex shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">bopfuse_simple   </td><td class="markdownTableBodyLeft">bopfuse   </td><td class="markdownTableBodyLeft">Fuse operation, simple shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bopsection   </td><td class="markdownTableBodyLeft">bopsection   </td><td class="markdownTableBodyLeft">Section    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">boptuc_2d   </td><td class="markdownTableBodyLeft">boptuc   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">boptuc_complex   </td><td class="markdownTableBodyLeft">boptuc   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">boptuc_simple   </td><td class="markdownTableBodyLeft">boptuc   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bsection   </td><td class="markdownTableBodyLeft">bsection   </td><td class="markdownTableBodyLeft">Section (old algorithm)   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_4"></a>
bugs</h3>
<p>This group allows testing cases coming from Mantis issues.</p>
<p>The grids are organized following OCCT module and category set for the issue in the Mantis tracker. See <a class="el" href="occt_contribution__tests.html#testmanual_5_2">Mapping of OCCT functionality to grid names in group bugs</a> chapter for details.</p>
<h3><a class="anchor" id="testmanual_5_1_5"></a>
caf</h3>
<p>This group allows testing OCAF functionality.</p>
<p>DRAW module: OCAFKERNEL.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">basic   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Basic attributes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bugs   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Saving and restoring of document    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">driver   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">OCAF drivers    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">named_shape   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft"><em><a class="elRef" href="../../refman/html/class_t_naming___named_shape.html">TNaming_NamedShape</a></em> attribute    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">presentation   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft"><em>AISPresentation</em> attributes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">tree   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Tree construction attributes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">xlink   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">XLink attributes   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_6"></a>
chamfer</h3>
<p>This group allows testing chamfer operations.</p>
<p>DRAW module: MODELING.</p>
<p>The test grid name is constructed depending on the type of the tested chamfers. Additional suffix <em>_complex</em> is used for test cases involving complex geometry (e.g. intersections of edges forming a chamfer); suffix <em>_sequence</em> is used for grids where chamfers are computed sequentially.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">equal_dist   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Equal distances from edge    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">equal_dist_complex   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Equal distances from edge, complex shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">equal_dist_sequence   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Equal distances from edge, sequential operations    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">dist_dist   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Two distances from edge    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">dist_dist_complex   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Two distances from edge, complex shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">dist_dist_sequence   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Two distances from edge, sequential operations    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">dist_angle   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Distance from edge and given angle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">dist_angle_complex   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Distance from edge and given angle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">dist_angle_sequence   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Distance from edge and given angle   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_7"></a>
de</h3>
<p>This group tests reading and writing of CAD data files (iges, step) to and from OCCT.</p>
<p>Test cases check transfer status, shape and attributes against expected reference values.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">iges_1, iges_2, iges_3   </td><td class="markdownTableBodyLeft">igesbrep, brepiges, ReadIges, WriteIges   </td><td class="markdownTableBodyLeft">IGES tests    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">step_1, step_2, step_3, step_4, step_5   </td><td class="markdownTableBodyLeft">stepread, stepwrite, ReadStep, WriteStep   </td><td class="markdownTableBodyLeft">STEP tests   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_8"></a>
demo</h3>
<p>This group allows demonstrating how testing cases are created, and testing DRAW commands and the test system as a whole.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">draw   </td><td class="markdownTableBodyLeft">getsource, restore   </td><td class="markdownTableBodyLeft">Basic DRAW commands    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">testsystem   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Testing system    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">samples   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">OCCT samples   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_9"></a>
draft</h3>
<p>This group allows testing draft operations.</p>
<p>DRAW module: MODELING.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Angle   </td><td class="markdownTableBodyLeft">depouille   </td><td class="markdownTableBodyLeft">Drafts with angle (inclined walls)   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_10"></a>
feat</h3>
<p>This group allows testing creation of features on a shape.</p>
<p>DRAW module: MODELING (package <em><a class="elRef" href="../../refman/html/class_b_rep_test.html">BRepTest</a></em>).</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">featdprism   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">featlf   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">featprism   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">featrevol   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">featrf   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft"></td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_11"></a>
heal</h3>
<p>This group allows testing the functionality provided by <em>ShapeHealing</em> toolkit.</p>
<p>DRAW module: <a class="elRef" href="../../refman/html/class_x_s_d_r_a_w.html">XSDRAW</a></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">fix_shape   </td><td class="markdownTableBodyLeft">fixshape   </td><td class="markdownTableBodyLeft">Shape healing    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">fix_gaps   </td><td class="markdownTableBodyLeft">fixwgaps   </td><td class="markdownTableBodyLeft">Fixing gaps between edges on a wire    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">same_parameter   </td><td class="markdownTableBodyLeft">sameparameter   </td><td class="markdownTableBodyLeft">Fixing non-sameparameter edges    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">same_parameter_locked   </td><td class="markdownTableBodyLeft">sameparameter   </td><td class="markdownTableBodyLeft">Fixing non-sameparameter edges    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">fix_face_size   </td><td class="markdownTableBodyLeft">DT_ApplySeq   </td><td class="markdownTableBodyLeft">Removal of small faces    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">elementary_to_revolution   </td><td class="markdownTableBodyLeft">DT_ApplySeq   </td><td class="markdownTableBodyLeft">Conversion of elementary surfaces to revolution    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">direct_faces   </td><td class="markdownTableBodyLeft">directfaces   </td><td class="markdownTableBodyLeft">Correction of axis of elementary surfaces    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">drop_small_edges   </td><td class="markdownTableBodyLeft">fixsmall   </td><td class="markdownTableBodyLeft">Removal of small edges    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">split_angle   </td><td class="markdownTableBodyLeft">DT_SplitAngle   </td><td class="markdownTableBodyLeft">Splitting periodic surfaces by angle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">split_angle_advanced   </td><td class="markdownTableBodyLeft">DT_SplitAngle   </td><td class="markdownTableBodyLeft">Splitting periodic surfaces by angle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">split_angle_standard   </td><td class="markdownTableBodyLeft">DT_SplitAngle   </td><td class="markdownTableBodyLeft">Splitting periodic surfaces by angle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">split_closed_faces   </td><td class="markdownTableBodyLeft">DT_ClosedSplit   </td><td class="markdownTableBodyLeft">Splitting of closed faces    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">surface_to_bspline   </td><td class="markdownTableBodyLeft">DT_ToBspl   </td><td class="markdownTableBodyLeft">Conversion of surfaces to b-splines    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">surface_to_bezier   </td><td class="markdownTableBodyLeft">DT_ShapeConvert   </td><td class="markdownTableBodyLeft">Conversion of surfaces to bezier    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">split_continuity   </td><td class="markdownTableBodyLeft">DT_ShapeDivide   </td><td class="markdownTableBodyLeft">Split surfaces by continuity criterion    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">split_continuity_advanced   </td><td class="markdownTableBodyLeft">DT_ShapeDivide   </td><td class="markdownTableBodyLeft">Split surfaces by continuity criterion    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">split_continuity_standard   </td><td class="markdownTableBodyLeft">DT_ShapeDivide   </td><td class="markdownTableBodyLeft">Split surfaces by continuity criterion    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">surface_to_revolution_advanced   </td><td class="markdownTableBodyLeft">DT_ShapeConvertRev   </td><td class="markdownTableBodyLeft">Convert elementary surfaces to revolutions, complex cases    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">surface_to_revolution_standard   </td><td class="markdownTableBodyLeft">DT_ShapeConvertRev   </td><td class="markdownTableBodyLeft">Convert elementary surfaces to revolutions, simple cases    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">update_tolerance_locked   </td><td class="markdownTableBodyLeft">updatetolerance   </td><td class="markdownTableBodyLeft">Update the tolerance of shape so that it satisfy the rule: toler(face)&lt;=toler(edge)&lt;=toler(vertex)   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_12"></a>
mesh</h3>
<p>This group allows testing shape tessellation (<em>BRepMesh</em>) and shading.</p>
<p>DRAW modules: MODELING (package <em><a class="elRef" href="../../refman/html/class_mesh_test.html">MeshTest</a></em>), VISUALIZATION (package <em><a class="elRef" href="../../refman/html/class_viewer_test.html">ViewerTest</a></em>)</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">advanced_shading   </td><td class="markdownTableBodyLeft">vdisplay   </td><td class="markdownTableBodyLeft">Shading, complex shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">standard_shading   </td><td class="markdownTableBodyLeft">vdisplay   </td><td class="markdownTableBodyLeft">Shading, simple shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">advanced_mesh   </td><td class="markdownTableBodyLeft">mesh   </td><td class="markdownTableBodyLeft">Meshing of complex shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">standard_mesh   </td><td class="markdownTableBodyLeft">mesh   </td><td class="markdownTableBodyLeft">Meshing of simple shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">advanced_incmesh   </td><td class="markdownTableBodyLeft">incmesh   </td><td class="markdownTableBodyLeft">Meshing of complex shapes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">standard_incmesh   </td><td class="markdownTableBodyLeft">incmesh   </td><td class="markdownTableBodyLeft">Meshing of simple shapes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">advanced_incmesh_parallel   </td><td class="markdownTableBodyLeft">incmesh   </td><td class="markdownTableBodyLeft">Meshing of complex shapes, parallel mode    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">standard_incmesh_parallel   </td><td class="markdownTableBodyLeft">incmesh   </td><td class="markdownTableBodyLeft">Meshing of simple shapes, parallel mode   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_13"></a>
mkface</h3>
<p>This group allows testing creation of simple surfaces.</p>
<p>DRAW module: MODELING (package <em><a class="elRef" href="../../refman/html/class_b_rep_test.html">BRepTest</a></em>)</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">after_trim   </td><td class="markdownTableBodyLeft">mkface   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">after_offset   </td><td class="markdownTableBodyLeft">mkface   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">after_extsurf_and_offset   </td><td class="markdownTableBodyLeft">mkface   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">after_extsurf_and_trim   </td><td class="markdownTableBodyLeft">mkface   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">after_revsurf_and_offset   </td><td class="markdownTableBodyLeft">mkface   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">mkplane   </td><td class="markdownTableBodyLeft">mkplane   </td><td class="markdownTableBodyLeft"></td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_14"></a>
nproject</h3>
<p>This group allows testing normal projection of edges and wires onto a face.</p>
<p>DRAW module: MODELING (package <em><a class="elRef" href="../../refman/html/class_b_rep_test.html">BRepTest</a></em>)</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Base   </td><td class="markdownTableBodyLeft">nproject   </td><td class="markdownTableBodyLeft"></td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_15"></a>
offset</h3>
<p>This group allows testing offset functionality for curves and surfaces.</p>
<p>DRAW module: MODELING (package <em><a class="elRef" href="../../refman/html/class_b_rep_test.html">BRepTest</a></em>)</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">compshape   </td><td class="markdownTableBodyLeft">offsetcompshape   </td><td class="markdownTableBodyLeft">Offset of shapes with removal of some faces    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">faces_type_a   </td><td class="markdownTableBodyLeft">offsetparameter, offsetload, offsetperform   </td><td class="markdownTableBodyLeft">Offset on a subset of faces with a fillet    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">faces_type_i   </td><td class="markdownTableBodyLeft">offsetparameter, offsetload, offsetperform   </td><td class="markdownTableBodyLeft">Offset on a subset of faces with a sharp edge    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">shape_type_a   </td><td class="markdownTableBodyLeft">offsetparameter, offsetload, offsetperform   </td><td class="markdownTableBodyLeft">Offset on a whole shape with a fillet    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">shape_type_i   </td><td class="markdownTableBodyLeft">offsetparameter, offsetload, offsetperform   </td><td class="markdownTableBodyLeft">Offset on a whole shape with a fillet    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">shape   </td><td class="markdownTableBodyLeft">offsetshape   </td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">wire_closed_outside_0_005, wire_closed_outside_0_025, wire_closed_outside_0_075, wire_closed_inside_0_005, wire_closed_inside_0_025, wire_closed_inside_0_075, wire_unclosed_outside_0_005, wire_unclosed_outside_0_025, wire_unclosed_outside_0_075   </td><td class="markdownTableBodyLeft">mkoffset   </td><td class="markdownTableBodyLeft">2d offset of closed and unclosed planar wires with different offset step and directions of offset ( inside / outside )   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_16"></a>
pipe</h3>
<p>This group allows testing construction of pipes (sweeping of a contour along profile).</p>
<p>DRAW module: MODELING (package <em><a class="elRef" href="../../refman/html/class_b_rep_test.html">BRepTest</a></em>)</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="elRef" href="../../refman/html/class_standard.html">Standard</a>   </td><td class="markdownTableBodyLeft">pipe   </td><td class="markdownTableBodyLeft"></td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_17"></a>
prism</h3>
<p>This group allows testing construction of prisms.</p>
<p>DRAW module: MODELING (package <em><a class="elRef" href="../../refman/html/class_b_rep_test.html">BRepTest</a></em>)</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">seminf   </td><td class="markdownTableBodyLeft">prism   </td><td class="markdownTableBodyLeft"></td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_18"></a>
sewing</h3>
<p>This group allows testing sewing of faces by connecting edges.</p>
<p>DRAW module: MODELING (package <em><a class="elRef" href="../../refman/html/class_b_rep_test.html">BRepTest</a></em>)</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">tol_0_01   </td><td class="markdownTableBodyLeft">sewing   </td><td class="markdownTableBodyLeft">Sewing faces with tolerance 0.01    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">tol_1   </td><td class="markdownTableBodyLeft">sewing   </td><td class="markdownTableBodyLeft">Sewing faces with tolerance 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">tol_100   </td><td class="markdownTableBodyLeft">sewing   </td><td class="markdownTableBodyLeft">Sewing faces with tolerance 100   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_19"></a>
thrusection</h3>
<p>This group allows testing construction of shell or a solid passing through a set of sections in a given sequence (loft).</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">solids   </td><td class="markdownTableBodyLeft">thrusection   </td><td class="markdownTableBodyLeft">Lofting with resulting solid    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">not_solids   </td><td class="markdownTableBodyLeft">thrusection   </td><td class="markdownTableBodyLeft">Lofting with resulting shell or face   </td></tr>
</table>
<h3><a class="anchor" id="testmanual_5_1_20"></a>
xcaf</h3>
<p>This group allows testing extended data exchange packages.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Grid   </th><th class="markdownTableHeadLeft">Commands   </th><th class="markdownTableHeadLeft">Functionality    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">dxc, dxc_add_ACL, dxc_add_CL, igs_to_dxc, igs_add_ACL, brep_to_igs_add_CL, stp_to_dxc, stp_add_ACL, brep_to_stp_add_CL, brep_to_dxc, add_ACL_brep, brep_add_CL   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Subgroups are divided by format of source file, by format of result file and by type of document modification. For example, <em>brep_to_igs</em> means that the source shape in brep format was added to the document, which was saved into igs format after that. The postfix <em>add_CL</em> means that colors and layers were initialized in the document before saving and the postfix <em>add_ACL</em> corresponds to the creation of assembly and initialization of colors and layers in a document before saving.   </td></tr>
</table>
<h2><a class="anchor" id="testmanual_5_2"></a>
Mapping of OCCT functionality to grid names in group &lt;em&gt;bugs&lt;/em&gt;</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">OCCT Module / Mantis category   </th><th class="markdownTableHeadLeft">Toolkits   </th><th class="markdownTableHeadLeft">Test grid in group bugs    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Application Framework   </td><td class="markdownTableBodyLeft">PTKernel, TKPShape, TKCDF, TKLCAF, TKCAF, TKBinL, TKXmlL, TKShapeSchema, TKPLCAF, TKBin, TKXml, TKPCAF, FWOSPlugin, TKStdLSchema, TKStdSchema, TKTObj, TKBinTObj, TKXmlTObj   </td><td class="markdownTableBodyLeft">caf    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="elRef" href="../../refman/html/class_draw.html">Draw</a>   </td><td class="markdownTableBodyLeft">TKDraw, TKTopTest, TKViewerTest, TKXSDRAW, TKDCAF, TKXDEDRAW, TKTObjDRAW, TKQADraw, DRAWEXE, Problems of testing system   </td><td class="markdownTableBodyLeft">draw    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Shape Healing   </td><td class="markdownTableBodyLeft">TKShHealing   </td><td class="markdownTableBodyLeft">heal    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Mesh   </td><td class="markdownTableBodyLeft">TKMesh, TKXMesh   </td><td class="markdownTableBodyLeft">mesh    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Data Exchange   </td><td class="markdownTableBodyLeft">TKIGES   </td><td class="markdownTableBodyLeft">iges    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Data Exchange   </td><td class="markdownTableBodyLeft">TKSTEPBase, TKSTEPAttr, TKSTEP209, TKSTEP   </td><td class="markdownTableBodyLeft">step    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Data Exchange   </td><td class="markdownTableBodyLeft">TKSTL, TKVRML   </td><td class="markdownTableBodyLeft">stlvrml    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Data Exchange   </td><td class="markdownTableBodyLeft">TKXSBase, TKXCAF, TKXCAFSchema, TKXDEIGES, TKXDESTEP, TKXmlXCAF, TKBinXCAF   </td><td class="markdownTableBodyLeft">xde    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Foundation Classes   </td><td class="markdownTableBodyLeft">TKernel, TKMath   </td><td class="markdownTableBodyLeft">fclasses    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Modeling_algorithms   </td><td class="markdownTableBodyLeft">TKGeomAlgo, TKTopAlgo, TKPrim, TKBO, TKBool, TKHLR, TKFillet, TKOffset, TKFeat, TKXMesh   </td><td class="markdownTableBodyLeft">modalg    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Modeling Data   </td><td class="markdownTableBodyLeft">TKG2d, TKG3d, TKGeomBase, TKBRep   </td><td class="markdownTableBodyLeft">moddata    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Visualization   </td><td class="markdownTableBodyLeft">TKService, TKV2d, TKV3d, TKOpenGl, TKMeshVS, TKNIS   </td><td class="markdownTableBodyLeft">vis   </td></tr>
</table>
<h2><a class="anchor" id="testmanual_5_3"></a>
Recommended approaches to checking test results</h2>
<h3><a class="anchor" id="testmanual_5_3_1"></a>
Shape validity</h3>
<p>Run command <em>checkshape</em> on the result (or intermediate) shape and make sure that <em>parse.rules</em> of the test grid or group reports bad shapes (usually recognized by word "Faulty") as error.</p>
<p>Example </p><div class="fragment"><div class="line">checkshape result</div>
</div><!-- fragment --><p>To check the number of faults in the shape command <em>checkfaults</em> can be used.</p>
<p>Use: checkfaults shape source_shape [ref_value=0]</p>
<p>The default syntax of <em>checkfaults</em> command: </p><div class="fragment"><div class="line">checkfaults results a_1</div>
</div><!-- fragment --><p>The command will check the number of faults in the source shape (<em>a_1</em>) and compare it with number of faults in the resulting shape (<em>result</em>). If shape <em>result</em> contains more faults, you will get an error: </p><div class="fragment"><div class="line">checkfaults results a_1</div>
<div class="line">Error : Number of faults is 5</div>
</div><!-- fragment --><p> It is possible to set the reference value for comparison (reference value is 4):</p>
<div class="fragment"><div class="line">checkfaults results a_1 4</div>
</div><!-- fragment --><p>If number of faults in the resulting shape is unstable, reference value should be set to "-1". As a result command <em>checkfaults</em> will return the following error:</p>
<div class="fragment"><div class="line">checkfaults results a_1 -1</div>
<div class="line">Error : Number of faults is UNSTABLE</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_2"></a>
Shape tolerance</h3>
<p>The maximal tolerance of sub-shapes of each kind of the resulting shape can be extracted from output of tolerance command as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">set</span> tolerance [tolerance result]</div>
<div class="line">regexp { *FACE +: +MAX=([-0-9.+eE]+)} $tolerance dummy max_face</div>
<div class="line">regexp { *EDGE +: +MAX=([-0-9.+eE]+)} $tolerance dummy max_edgee</div>
<div class="line">regexp { *VERTEX +: +MAX=([-0-9.+eE]+)} $tolerance dummy max_vertex</div>
</div><!-- fragment --><p>It is possible to use command <em>checkmaxtol</em> to check maximal tolerance of shape and compare it with reference value.</p>
<p>Use: checkmaxtol shape [options...]</p>
<p>Allowed options are:</p><ul>
<li><em>-ref</em> &ndash; reference value of maximum tolerance;</li>
<li><em>-source</em> &ndash; list of shapes to compare with;</li>
<li><em>-min_tol</em> &ndash; minimum tolerance for comparison;</li>
<li><em>-multi_tol</em> &ndash; tolerance multiplier.</li>
</ul>
<p>The default syntax of <em>checkmaxtol</em> command for comparison with the reference value: </p><div class="fragment"><div class="line">checkmaxtol result -ref 0.00001</div>
</div><!-- fragment --><p>There is an opportunity to compare max tolerance of resulting shape with max tolerance of source shape. In the following example command <em>checkmaxtol</em> gets max tolerance among objects <em>a_1</em> and <em>a_2</em>. Then it chooses the maximum value between founded tolerance and value -min_tol (0.000001) and multiply it on the coefficient -multi_tol (i.e. 2):</p>
<div class="fragment"><div class="line">checkmaxtol result -source {a_1 a_2} -min_tol 0.000001 -multi_tol 2</div>
</div><!-- fragment --><p>If the value of maximum tolerance more than founded tolerance for comparison, the command will return an error.</p>
<p>Also, command <em>checkmaxtol</em> can be used to get max tolerance of the shape:</p>
<div class="fragment"><div class="line"><span class="keyword">set</span> maxtol [checkmaxtol result]</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_3"></a>
Shape volume, area, or length</h3>
<p>Use command <em>vprops, sprops,</em> or <em>lprops</em> to correspondingly measure volume, area, or length of the shape produced by the test. The value can be extracted from the result of the command by <em>regexp</em>.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="preprocessor"># check area of shape result with 1% tolerance</span></div>
<div class="line">regexp {Mass +: +([-0-9.+eE]+)} [sprops result] dummy area</div>
<div class="line"><span class="keywordflow">if</span> { abs($area - $expected) &gt; 0.1 + 0.01 * abs ($area) } {</div>
<div class="line">    puts <span class="stringliteral">&quot;Error: The area of result shape is $area, while expected $expected&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_4"></a>
Memory leaks</h3>
<p>The test system measures the amount of memory used by each test case. Considerable deviations (as well as the overall difference) in comparison with reference results can be reported by command <em>testdiff</em> (see <a class="el" href="occt_contribution__tests.html#testmanual_4_4">Checking non-regression of performance, memory, and visualization</a>).</p>
<p>To check memory leak on a particular operation, run it in a cycle, measure the memory consumption at each step and compare it with a threshold value. The command <em>checktrend</em> (defined in <em>tests/bugs/begin</em>) can be used to analyze a sequence of memory measurements and to get a statistically based evaluation of the leak presence.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="keyword">set</span> listmem {}</div>
<div class="line"><span class="keywordflow">for</span> {<span class="keyword">set</span> i 1} {$i &lt; 100} {incr i} {</div>
<div class="line"><span class="preprocessor">    # run suspect operation </span></div>
<div class="line">    …</div>
<div class="line"><span class="preprocessor">    # check memory usage (with tolerance equal to half page size)</span></div>
<div class="line">    lappend listmem [expr [meminfo <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a0770ea2ad5f7980d6eff6fd05a67099d">w</a>] / 1024]</div>
<div class="line">    <span class="keywordflow">if</span> { [checktrend $listmem 0 256 <span class="stringliteral">&quot;Memory leak detected&quot;</span>] } {</div>
<div class="line">        puts <span class="stringliteral">&quot;No memory leak, $i iterations&quot;</span></div>
<div class="line">        <span class="keywordflow">break</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceopencascade_html_a0770ea2ad5f7980d6eff6fd05a67099d"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#a0770ea2ad5f7980d6eff6fd05a67099d">w</a></div><div class="ttdeci">GLint GLint GLint GLint w</div></div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_5"></a>
Visualization</h3>
<p>The following command sequence allows you to take a snapshot of the viewer, give it the name of the test case, and save in the directory indicated by Tcl variable <em>imagedir</em>.</p>
<div class="fragment"><div class="line">vinit</div>
<div class="line">vclear</div>
<div class="line">vdisplay result</div>
<div class="line">vsetdispmode 1</div>
<div class="line">vfit</div>
<div class="line">vzfit</div>
<div class="line">vdump $imagedir/${casename}_shading.png</div>
</div><!-- fragment --><p>This image will be included in the HTML log produced by <em>testgrid</em> command and will be checked for non-regression through comparison of images by command <em>testdiff</em>.</p>
<p>Also it is possible to use command <em>checkview</em> to make a snapshot of the viewer.</p>
<p>Use: checkview [options...] Allowed options are:</p><ul>
<li><em>-display shapename </em> &ndash; displays shape with name <em>shapename</em>;</li>
<li><em>-3d </em> &ndash; displays shape in 3d viewer;</li>
<li><em>-2d [ v2d / smallview ] </em> - displays shape in 2d viewer (the default viewer is <em>smallview</em>);</li>
<li><em>-path PATH</em> &ndash; sets the location of the saved viewer screenshot;</li>
<li><em>-vdispmode N</em> &ndash; sets <em>vdispmode</em> for 3d viewer (default value is 1)</li>
<li><em>-screenshot</em> &ndash; makes a screenshot of already created viewer</li>
<li>The procedure can check a property of shape (length, area or volume) and compare it with value <em>N</em>:<ul>
<li><em>-l [N]</em></li>
<li><em>-s [N]</em></li>
<li><em>-v [N]</em></li>
<li>If the current property is equal to value <em>N</em>, the shape is marked as valid in the procedure.</li>
<li>If value <em>N</em> is not given, the procedure will mark the shape as valid if the current property is non-zero.</li>
</ul>
</li>
<li><em>-with {a b c}</em> &ndash; displays shapes <em>a, b</em> and <em>c</em> together with the shape (if the shape is valid)</li>
<li><em>-otherwise {d e f}</em> &ndash; displays shapes <em>d, e</em> and <em>f</em> instead of the shape (if the shape is NOT valid)</li>
</ul>
<p>Note that is required to use either option <em> -2d </em> or option <em> -3d</em>.</p>
<p>Examples: </p><div class="fragment"><div class="line">checkview -display result -2d -path ${imagedir}/${test_image}.png</div>
<div class="line">checkview -display result -3d -path ${imagedir}/${test_image}.png</div>
<div class="line">checkview -display result_2d -2d v2d -path ${imagedir}/${test_image}.png</div>
</div><!-- fragment --><div class="fragment"><div class="line">box <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> 10 10 10</div>
<div class="line">box <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a> 5 5 5 10 10 10</div>
<div class="line">bcut result <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a> <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a></div>
<div class="line"><span class="keyword">set</span> result_vertices [explode result <a class="codeRef" href="../../refman/html/namespaceopencascade.html#afebb5dc277cef37d6dc94421db317ebb">v</a>]</div>
<div class="line">checkview -display result -2d -with ${result_vertices} -otherwise { <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a> } -l -path ${imagedir}/${test_image}.png</div>
<div class="ttc" id="anamespaceopencascade_html_afebb5dc277cef37d6dc94421db317ebb"><div class="ttname"><a href="../../refman/html/namespaceopencascade.html#afebb5dc277cef37d6dc94421db317ebb">v</a></div><div class="ttdeci">const GLint * v</div></div>
</div><!-- fragment --><div class="fragment"><div class="line">box <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> 10 10 10</div>
<div class="line">box <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a> 5 5 5 10 10 10</div>
<div class="line">bcut result <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a> <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a></div>
<div class="line">vinit</div>
<div class="line">vdisplay <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a> <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a5bb39a61f24f11176540a2c890f722bb">b</a></div>
<div class="line">vfit</div>
<div class="line">checkview -screenshot -3d -path ${imagedir}/${test_image}.png</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_6"></a>
Number of free edges</h3>
<p>Procedure <em>checkfreebounds</em> compares the number of free edges with a reference value.</p>
<p>Use: checkfreebounds shape ref_value [options...]</p>
<p>Allowed options are:</p><ul>
<li><em>-tol N</em> &ndash; used tolerance (default -0.01);</li>
<li><em>-type N</em> &ndash; used type, possible values are "closed" and "opened" (default "closed").</li>
</ul>
<div class="fragment"><div class="line">checkfreebounds result 13</div>
</div><!-- fragment --><p>Option <em>-tol N</em> defines tolerance for command <em>freebounds</em>, which is used within command <em>checkfreebounds</em>.</p>
<p>Option <em>-type N</em> is used to select the type of counted free edges: closed or open.</p>
<p>If the number of free edges in the resulting shape is unstable, the reference value should be set to "-1". As a result command <em>checkfreebounds</em> will return the following error:</p>
<div class="fragment"><div class="line">checkfreebounds result -1</div>
<div class="line">Error : Number of free edges is UNSTABLE</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_7"></a>
Compare numbers</h3>
<p>Procedure <em>checkreal</em> checks the equality of two reals with a tolerance (relative and absolute).</p>
<p>Use: checkreal name value expected tol_abs tol_rel</p>
<div class="fragment"><div class="line">checkreal <span class="stringliteral">&quot;Some important value&quot;</span> $value 5 0.0001 0.01</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_8"></a>
Check number of sub-shapes</h3>
<p>Procedure <em>checknbshapes</em> compares the number of sub-shapes in "shape" with the given reference data.</p>
<p>Use: checknbshapes shape [options...]</p>
<p>Allowed options are:</p><ul>
<li><em>-vertex N</em></li>
<li><em>-edge N</em></li>
<li><em>-wire N</em></li>
<li><em>-face N</em></li>
<li><em>-shell N</em></li>
<li><em>-solid N</em></li>
<li><em>-compsolid N</em></li>
<li><em>-compound N</em></li>
<li><em>-shape N</em></li>
<li><em>-t</em> &ndash; compares the number of sub-shapes in "shape" counting the same sub-shapes with different location as different sub-shapes.</li>
<li><em>-m msg</em> &ndash; prints "msg" in case of error</li>
</ul>
<div class="fragment"><div class="line">checknbshapes result -vertex 8 -edge 4</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_9"></a>
Check pixel color</h3>
<p>Command <em>checkcolor</em> can be used to check pixel color.</p>
<p>Use: checkcolor x y red green blue</p>
<p>where:</p><ul>
<li><em>x, y</em> &ndash; pixel coordinates;</li>
<li><em>red green blue</em> &ndash; expected pixel color (values from 0 to 1).</li>
</ul>
<p>This procedure checks color with tolerance (5x5 area).</p>
<p>Next example will compare color of point with coordinates x=100 y=100 with RGB color R=1 G=0 B=0. If colors are not equal, procedure will check the nearest ones points (5x5 area) </p><div class="fragment"><div class="line">checkcolor 100 100 1 0 0</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_10"></a>
Compute length, area and volume of input shape</h3>
<p>Procedure <em>checkprops</em> computes length, area and volume of the input shape.</p>
<p>Use: checkprops shapename [options...]</p>
<p>Allowed options are:</p><ul>
<li><em>-l LENGTH</em> &ndash; command <em>lprops</em>, computes the mass properties of all edges in the shape with a linear density of 1;</li>
<li><em>-s AREA</em> &ndash; command <em>sprops</em>, computes the mass properties of all faces with a surface density of 1;</li>
<li><em>-v VOLUME</em> &ndash; command <em>vprops</em>, computes the mass properties of all solids with a density of 1;</li>
<li><em>-eps EPSILON</em> &ndash; the epsilon defines relative precision of computation;</li>
<li><em>-deps DEPSILON</em> &ndash; the epsilon defines relative precision to compare corresponding values;</li>
<li><em>-equal SHAPE</em> &ndash; compares area, volume and length of input shapes. Puts error if they are not equal;</li>
<li><em>-notequal SHAPE</em> &ndash; compares area, volume and length of input shapes. Puts error if they are equal.</li>
</ul>
<p>Options <em> -l, -s </em> and <em> -v</em> are independent and can be used in any order. Tolerance <em>epsilon</em> is the same for all options.</p>
<div class="fragment"><div class="line">checkprops result -s 6265.68 </div>
<div class="line">checkprops result -s -equal FaceBrep</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_11"></a>
Parse output dump and compare it with reference values</h3>
<p>Procedure <em>checkdump</em> is used to parse output dump and compare it with reference values.</p>
<p>Use: checkdump shapename [options...]</p>
<p>Allowed options are:</p><ul>
<li><em>-name NAME</em> &ndash; list of parsing parameters (e.g. Center, Axis, etc.);</li>
<li><em>-ref VALUE</em> &ndash; list of reference values for each parameter in <em>NAME</em>;</li>
<li><em>-eps EPSILON</em> &ndash; the epsilon defines relative precision of computation.</li>
</ul>
<div class="fragment"><div class="line">checkdump result -<a class="codeRef" href="../../refman/html/namespaceopencascade.html#ac01e57e97093653a0184fe1116009e15">name</a> {Center Axis XAxis YAxis Radii} -ref {{-70 0} {-1 -0} {-1 -0} {0 -1} {20 10}} -eps 0.01</div>
</div><!-- fragment --><h3><a class="anchor" id="testmanual_5_3_12"></a>
Compute length of input curve</h3>
<p>Procedure <em>checklength</em> computes length of the input curve.</p>
<p>Use: checklength curvename [options...]</p>
<p>Allowed options are:</p><ul>
<li><em>-l LENGTH</em> &ndash; command <em>length</em>, computes the length of the input curve with precision of computation;</li>
<li><em>-eps EPSILON</em> &ndash; the epsilon defines a relative precision of computation;</li>
<li><em>-equal CURVE</em> &ndash; compares the length of input curves. Puts error if they are not equal;</li>
<li><em>-notequal CURVE</em> &ndash; compares the length of input curves. Puts error if they are equal.</li>
</ul>
<div class="fragment"><div class="line">checklength cp1 -l 7.278</div>
<div class="line">checklength res -l -equal ext_1</div>
</div><!-- fragment --> <h3><a class="anchor" id="testmanual_5_3_13"></a>
Check maximum deflection, number of triangles and nodes in mesh</h3>
<p>Command <em>checktrinfo</em> can be used to to check the maximum deflection, as well as the number of nodes and triangles in mesh.</p>
<p>Use: checktrinfo shapename [options...]</p>
<p>Allowed options are:</p><ul>
<li><em>-tri [N]</em> &ndash; compares the current number of triangles in <em>shapename</em> mesh with the given reference data. If reference value N is not given and the current number of triangles is equal to 0, procedure <em>checktrinfo</em> will print an error.</li>
<li><em>-nod [N]</em> &ndash; compares the current number of nodes in <em>shapename</em> mesh with the given reference data. If reference value N is not given and the current number of nodes is equal to 0, procedure <em>checktrinfo</em> will print an error.</li>
<li><em>-defl [N]</em> &ndash; compares the current value of maximum deflection in <em>shapename</em> mesh with the given reference data. If reference value N is not given and current maximum deflection is equal to 0, procedure <em>checktrinfo</em> will print an error.</li>
<li><em>-max_defl N</em> &ndash; compares the current value of maximum deflection in <em>shapename</em> mesh with the max possible value.</li>
<li><em>-tol_abs_tri N</em> &ndash; absolute tolerance for comparison of number of triangles (default value 0).</li>
<li><em>-tol_rel_tri N</em> &ndash; relative tolerance for comparison of number of triangles (default value 0).</li>
<li><em>-tol_abs_nod N</em> &ndash; absolute tolerance for comparison of number of nodes (default value 0).</li>
<li><em>-tol_rel_nod N</em> &ndash; relative tolerance for comparison of number of nodes (default value 0).</li>
<li><em>-tol_abs_defl N</em> &ndash; absolute tolerance for deflection comparison (default value 0).</li>
<li><em>-tol_rel_defl N</em> &ndash; relative tolerance for deflection comparison (default value 0).</li>
<li><em>-ref [trinfo a]</em> &ndash; compares deflection, number of triangles and nodes in <em>shapename</em> and <em>a</em>.</li>
</ul>
<p>Note that options <em> -tri, -nod </em> and <em> -defl </em> do not work together with option <em> -ref</em>.</p>
<p>Examples:</p>
<p>Comparison with some reference values: </p><div class="fragment"><div class="line">checktrinfo result -tri 129 -nod 131 -defl 0.01</div>
</div><!-- fragment --><p>Comparison with another mesh: </p><div class="fragment"><div class="line">checktrinfo result -ref [tringo <a class="codeRef" href="../../refman/html/namespaceopencascade.html#a8bfaa44f937da5cb5aea81e82f918d0a">a</a>]</div>
</div><!-- fragment --><p>Comparison of deflection with the max possible value: </p><div class="fragment"><div class="line">checktrinfo result -max_defl 1</div>
</div><!-- fragment --><p>Check that the current values are not equal to zero: </p><div class="fragment"><div class="line">checktrinfo result -tri -nod -defl</div>
</div><!-- fragment --><p>Check that the number of triangles and the number of nodes are not equal to some specific values: </p><div class="fragment"><div class="line">checktrinfo result -tri !10 -nod !8</div>
</div><!-- fragment --><p>It is possible to compare current values with reference values with some tolerances. Use options <em>-tol_* </em> for that. </p><div class="fragment"><div class="line">checktrinfo result -defl 1 -tol_abs_defl 0.001</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Oct 30 2021 10:59:39 for Open CASCADE Technology by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
